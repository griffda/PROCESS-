*#header-title : Test file for the new `PROCESS` output tool. Based on the 2017 
*#header-title : baseline file. As much information as you like can enter this 
*#header-title : statement. It can include markdown and other characters.

runtitle = "PROCESS runs for new baseline design EU DEMO1 2017: 02.05.2017"

*#header-Numerics :

ioptimz  = 1 * for optimisation VMCON only
minmax   = 1 * Switch for figure-of-merit (see lablmm for descriptions)
epsvmc   = 1.0e-8 * Error tolerance for vmcon


*#header-Physics : 


*#subheader-Plasma-physics : 

*#constraint-1 : apply the beta consistency check
icc = 1 * Beta

*#constraint-24 : 
icc      = 24 * Beta upper limit
ixc      = 36 * fbetatry
ixc      = 5 * beta

*#constraint-2 : enforce consistency of the power balance of the machine
icc = 2 * Global power balance

*#constraint-5 : allow the density to exceed the limit (the limit is the Greenwald density)
icc       = 5 * Density upper limit
ixc       = 9 * fdene
boundu(9) = 1.2

ixc       = 6 * dene
boundl(6) = 6.0E+19
dene      = 7.98e+19 * Electron density (/m3)

*#constraint-8 : surface flux of neutrons in MW/m2. Not limiting in baseline case
icc     = 8 * Neutron wall load upper limit
ixc     = 14 * fwalld
walalw  = 8.0 * Allowable wall-load (mw/m2)

*#constraint-15 : L-H power threshold limit
icc         = 15 * L-H power threshold limit
ixc         = 103 * flhthresh
boundu(103) = 10.0

*#iteration-variable-4 : 
ixc       = 4 * te
boundu(4) = 150.0

*#iteration-variable-10 : 
ixc        = 10 * hfact
boundu(10) = 1.1

*#iteration-variable-18 : 
ixc        = 18 * q
boundl(18) = 3.0

*#iteration-variable-44 : 
ixc      = 44 * fvsbrnni
fvsbrnni = 0.4434 * Fraction of the plasma current produced by non-inductive means

*#in-scrapli :
scrapli = 0.225 * Gap between plasma and first wall; inboard side (m)

*#in-scraplo :
scraplo = 0.225 * Gap between plasma and first wall; outboard side (m)

*#in-alphan :
alphan = 1.00 * Density profile index

*#in-alphat :
alphat = 1.45 * Temperature profile index

*#in-aspect :
aspect = 3.1 * Aspect ratio

*#in-fkzohm :
fkzohm = 1.0245 * Zohm elongation scaling adjustment factor (ishape=2; 3)

*#in-gamma :
gamma = 0.3 * Ejima coefficient for resistive startup v-s formula

*#in-ibss : 
ibss = 4 * Switch for bootstrap current scaling;

*#in-iculbl :
iculbl   = 1 * Switch for beta limit scaling (constraint equation 24);

*#in-icurr :
icurr    = 4 * Switch for plasma current scaling to use;

*#in-idensl : 
idensl   = 7 * Switch for density limit to enforce (constraint equation 5);

*#in-ifalphap :
ifalphap = 1 * Switch for fast alpha pressure calculation;

*#in-ipedestal :
ipedestal = 1 * Switch for pedestal profiles;

*#in-iscdens :
iscdens = 1 * set pedestal-top density as fgwped * Greenwald density limit 

*#in-fgwped : set to 85 % after discussion with **WPPMI**
fgwped = 0.85 * fraction of Greenwald density to set as pedestal-top density

*#in-neped : 
neped = 0.678e20 * Electron density of pedestal (/m3) (ipedestal=1)

*#in-nesep :
nesep = 0.2e20 * Electron density at separatrix (/m3) (ipedestal=1)

*#in-rhopedn :
rhopedn = 0.94 * R/a of density pedestal (ipedestal=1)

*#in-rhopedt :
rhopedt = 0.94 * R/a of temperature pedestal (ipedestal=1)

*#in-tbeta :
tbeta = 2.0 * Temperature profile index beta  (ipedestal=1)

*in-teped :
teped = 5.5 * Electron temperature of pedestal (kev) (ipedestal=1)

*#in-tesep :
tesep = 0.1 * Electron temperature at separatrix (kev) (ipedestal=1)

*#in-iprofile :
iprofile = 1 * Switch for current profile consistency;

*#in-isc : 
isc = 34 * Switch for energy confinement time scaling law

*#in-ishape :
ishape = 2 * Switch for plasma cross-sectional shape calculation;

*#in-kappa : 
kappa = 1.848 * Plasma separatrix elongation (calculated if ishape > 0)

*#in-q0 :
q0 = 1.0 * Safety factor on axis

*#in-ralpne :
ralpne = 0.1 * Thermal alpha density / electron density (iteration variable 109)

*#in-snull :
snull = 1 * Switch for single null / double null plasma;

*#in-ssync :
ssync = 0.6 * Synchrotron wall reflectivity factor

*#in-triang :
triang = 0.5 * Plasma separatrix triangularity (calculated if ishape=1; 3 or 4)


*#subheader-divertor-physics :

*#constraint-68 : implemented constraint instead of `psep/r` on request of **PMI**
icc         = 68 * Pseparatrix Bt / q A R
ixc         = 117 *fpsepbqar
fpsepbqar   = 9.0E-01
psepbqarmax = 9.2D0 * maximum ratio of Psep*Bt/qAR (MWT/m)


*#subheader-Impurity-radiation : 

*#in-imprad-model : use Hanni's impurity radiation model
imprad_model = 1 * Switch for impurity radiation model;

*#in-coreradius : set to 0.75 after discussion with **WPPMI**
coreradius = 0.75 * Normalised radius defining the 'core' region

*#in-coreradiationfraction : set to 0.6 after discussion with **WPPMI**
coreradiationfraction = 0.6 * fraction of radiation from 'core' region that is subtracted from the loss pow

*#iteration-variable-135 : Xenon is seeded impurity
ixc     = 135 * fimp(13)
fimp(1) = 1.0
fimp(2) = 0.1
fimp(3) = 0.0
fimp(4) = 0.0
fimp(5) = 0.0
fimp(6) = 0.0
fimp(7) = 0.0
fimp(8) = 0.0
fimp(9) = 0.0
fimp(10) = 0.0
fimp(11) = 0.0
fimp(12) = 0.0
fimp(13) = 0.00044
fimp(14) = 5e-05


*#header-General : 


*#subheader-Costs :

*#in-output_costs : costs model turned off
output_costs = 0

*#in-cost_model : 1990 model
cost_model = 0

*#in-iavail : use input availability
iavail = 0 * Switch for plant availability model

*#in-cfactr : 
cfactr = 0.75 * Total plant availability fraction


*#subheader-Build : 

*#constraint-11 : ensure radial build is consistent with plasma major radius
icc = 11 * Radial build (consistency equation)

*#iteration-variable-3 : 
ixc       = 3 * rmajor
boundu(3) = 13
rmajor    = 9.072 * Plasma major radius (m)

*#iteration-variable-13 : 
ixc   = 13 * tfcth
tfcth = 1.05 * Inboard tf coil thickness; (centrepost for st) (m)

*#iteration-variable-16 :
ixc   = 16 * ohcth
ohcth = 0.8181 * Central solenoid thickness (m)

*#iteration-variable-29 : 
ixc        = 29 * bore
boundl(29) = 0.1
bore       = 2.483 * Central solenoid inboard radius (m)

*#iteration-variable-42 : 
ixc        = 42 * gapoh
boundl(42) = 0.05
boundu(42) = 0.1
gapoh      = 0.05 * Gap between central solenoid and tf coil (m)

*#iteration-variable-61 : lower bound set to 2 cm after communication from **WPPMI**
ixc        = 61 * gapds
boundl(61) = 0.02
gapds      = 0.12 * Gap between inboard vacuum vessel and tf coil (m)

*#in-blnkith : set to 0.755 m after discussion with **WPPMI** 
blnkith = 0.762 * Inboard blanket thickness (m)

*#in-blnkoth : set to 0.982 m after discussion with **WPPMI**
* blnkoth = 0.982 * Outboard blanket thickness (m)

*-------------------Scan Module--------------------*
isweep = 1  * number of scan points to calculate
nsweep = 41 * blnkoth
sweep = 0.982

*#in-ddwex : 
ddwex = 0.15 * Cryostat thickness (m)

*#in-ddwi : set to 0.3 m after discussion with **WPPMI**
ddwi = 0.30 * Vacuum vessel thickness (tf coil / shield) (m)

*#in-gapomin : set to 0.2 m after discussion with **WPPMI**
gapomin = 0.20 * Minimum gap between outboard vacuum vessel and tf coil (m)

*#in-shldith : set to 0.3 m after discussion with **WPPMI**
shldith = 0.30 * Inboard shield thickness (m)

*#in-shldoth : set to 0.8 m after discussion with **WPPMI**
shldoth = 0.80 * Outboard shield thickness (m)

*#in-shldtth : set to 0.3 m after discussion with **WPPMI**
shldtth = 0.30 * Upper/lower shield thickness (m)

*#in-tftsgap : set to 0.05 m after discussion with **WPPMI**
tftsgap = 0.05 * manufacturing/thermal expansion gap between TF and thermal shield (m) 

*#in-vgap2 : set to 0.05 m after discussion with **WPPMI**
vgap2 = 0.05 * Vertical gap between vacuum vessel and tf coil (m)

*#in-vgap : set to 1.6 m after discussion with **WPPMI**
vgap = 1.60 * Vertical gap between x-point and divertor (m)

*#in-vvblgap : set to 0.02 m after discussion with **WPPMI**
vvblgap = 0.02 * gap between vacuum vessel and blanket (m) 

*#in-divfix :
divfix   = 0.621 * Divertor structure vertical thickness (m)


*#subheader-Times :

*#constraint-13 : set burn time equal to `tbrnmn` as `f-value` not iteration variable
icc     = 13 * Burn time lower limit
tbrnmn  = 7.2e3 * Minimum burn time (s)

*#in-lpulse : 
lpulse = 1 * Switch for reactor model;

*#in-tdwell : set to 0 after discussion with **WPPMI**. Assumed pump-down can 
*#in-tdwell : happen at same time as magnet recharge
tdwell = 0 * dwell time (s)

*#in-pulsetimings : ramp up and down set to `Ip/0.1` (communication with **WPPMI**)
pulsetimings = 0

*#in-tramp : pre-magnetisation time set to 500 s in discussion with **WPPMI**
tramp = 500.0

*#in-tlife :
tlife    = 40 * Plant life (years)


*#header-Balance-of-plant : 

*#constraint-16 : set net electric power equal to `pnetelin` as `fpnetel` not iteration variable
icc      = 16 * Net electric power lower limit
fpnetel  = 1.0 * F-value for net electric power
pnetelin = 500.0 * Required net electric power (Mw)

*#in-primary_pumping : Matti's BoP model
primary_pumping = 3 * Switch for pumping power for primary coolant

*#in-etath :
etath    = 0.375 * Thermal to electric conversion efficiency; input if ipowerflow=0

*#in-ipowerflow : 
ipowerflow = 0 * Switch for power flow model;

*#in-htpmw_div : set to zero, so total (blkt, shld, div, fw) is 155
htpmw_div = 0

*#in-htpmw_shld : set to zero, so total (blkt, shld, div, fw) is 155
htpmw_shld = 0

*#in-htpmw_blkt : set to zero, so total (blkt, shld, div, fw) is 155
htpmw_blkt = 0 * blanket primary pumping power He (MW)

*#in-htpmw_fw : set to 155 MW, so total (blkt, shld, div, fw) is 155
htpmw_fw = 155 * first wall primary pumping power He (MW)

*#in-etahtp : 
etahtp = 0.87 * mechanical pump wall-plug efficiency

*#in-inuclear : 
inuclear = 1

* Nuclear heating of cryogenic components (MW)      (qnuc/1.0D6)   1.292E-02  OP
*#in-qnuc : problem with nuclear heating after blanket size reduction. Input instead.
qnuc = 1.292E4 * Nuclear heating of cryogenic components (MW)

*#in-iprimshld : 
iprimshld = 1

*#in-etaiso :
etaiso = 0.9  * isentropic efficiency of FW and blanket coolant pumps

*#in-secondary_cycle :
secondary_cycle = 2  * user input thermal-electric efficiency (etath)


*#header-Heating-and-current-drive : The current DEMO baseline in PROCESS assumes only ECRH heating
*#header-Heating-and-current-drive : and current drive as PROCESS can only handle one type of HCD option.


*#constraint-30 : `fpinj` not iteration variable so power fixed at maximum `pinjalw`
icc     = 30 * Injection power upper limit
pinjalw = 50.0 * Maximum allowable value for injected power (mw)

*#in-bscfmax : keep bootstrap fraction to physical values
bscfmax  = 0.99 * Maximum fraction of plasma current from bootstrap;

*#in-iefrf : 
iefrf    = 10 * Switch for current drive efficiency model;

*#in-gamma_ecrh : 
gamma_ecrh = 0.30 * ECRH gamma_CD (user input)

*#in-etaech :
etaech = 0.4 * ECRH wall-plug efficiency


*#header-Magnets : 


*#subheader-TF-coils : 

*#constraint-10 : ensure toroidal field is consistent with 1/R scaling
icc = 10 * Toroidal field 1/R

*#constraint-31 : stress limit from ITER class I TF steels (660 MPa) but as 
*#constraint-31 : out-of-plane forces ignored limit lowered to 600 MPa
icc = 31 * TF coil case stress upper limit
ixc = 48 * fstrcase

*#constraint-32 : stress limit from ITER class I TF steels (660 MPa) but as 
*#constraint-32 : out-of-plane forces ignored limit lowered to 600 MPa
icc      = 32 * TF coil conduit stress upper limit
ixc      = 49 * fstrcond
alstrtf  = 6.0E8 * allowable stress in TF coil (Pa)

*#constraint-34 : dump voltage maximum at 10 kV in agreement with **WPMAG**
icc        = 34 * Dump voltage upper limit
ixc        = 51 * fvdump
fvdump     = 0.6116 * F-value for dump voltage
ixc        = 52 * vdalw maximum voltage across TF coil during quench (kV)
boundu(52) = 10.0
vdalw      = 10.00 * Max voltage across tf coil during quench (kv)
ixc        = 56 * tdmptf
tdmptf     = 30.0 * Dump time for tf coil (s)

*#constraint-65 :
icc      = 65 * dump time by VV stresses
sigvvall = 9.3e7 * allowable stress from TF quench in vacuum vessel (Pa)
ixc      = 113 *ftaucq

*#constraint-35 :
icc     = 35 * J_winding pack/J_protection upper limit (TFC)
ixc     = 53 * fjprot
fjprot  = 1.0 * F-value for tf coil winding pack current density

*#constraint-36 : set to 1.5 K in agreement with **WPMAG**
icc      = 36 * TF temp margin
tmargmin = 1.500 * Minimum allowable temperature margin (cs and tf coils) (k)
ixc      = 54 * ftmargtf

*#constraint-33 : 
icc = 33 * I_op/I_Crit
ixc = 50 * fiooic

*#iteration-variable-2 : 
ixc       = 2 * bt
boundu(2) = 20.0

*#iteration-variable-12 : 
ixc    = 12 * oacdcp
oacdcp = 10050000.0 * Overall current density in tf coil inboard legs (a/m2)

*#iteration-variable-57 : 
ixc    = 57 * thkcas
thkcas = 0.495 * Inboard tf coil case outer (non-plasma side) thickness (m)

*#iteration-variable-58 : lower bound set to 8 mm after discussion with **WPMAG**
ixc        = 58 * thwcndut
boundl(58) = 8.0d-3
thwcndut = 0.008 * Tf coil conduit case thickness (m)

*#iteration-variable-60 : 
ixc        = 60 * cpttf
boundl(60) = 6.0e4
boundu(60) = 9.0e4
cpttf    = 6.5e+04 * Tf coil current per turn (a);

*#iteration-variable-59 : 
ixc        = 59 * copper fraction of cable conductor (TF coils)
boundl(59) = 0.50
boundu(59) = 0.94

*#in-isumattf : use WST scaling on advice of **WPMAG**
isumattf = 5

*#in-ripmax :
ripmax   = 0.6 * Maximum allowable toroidal field ripple amplitude

*#in-tfno : set to 16 on advice of **WPPMI**
tfno     = 16 * Number of tf coils (default = 50 for stellarators)

*#in-casthi :
casthi   = 0.06 * Inboard tf coil case inner \(plasma side) thickness (m)

*#in-casths :
casths   = 0.05 * Inboard tf coil sidewall case thickness (m)

*#in-dhecoil : set to 10 mm on advice of **WPPMI**
dhecoil  = 0.010 * diameter of He coil in TF winding (m) 

*#in-tftmp : 
tftmp    = 4.750 * Peak helium coolant temperature in tf coils and pf coils (k)

*#in-tinstf : set to 8 mm on advice of **WPPMI**
tinstf   = 0.008 * Ground insulation thickness surrounding winding pack (m)

*#in-thicndut : set to 1.5 mm on advice of **WPPMI**
thicndut = 1.5d-3 * Conduit insulation thickness (m)

*#in-vftf :
vftf     = 0.300 * Coolant fraction of tfc 'cable' (itfsup=1); or of tfc leg (itfsup=0)

*#in-strncon : set to 0.66 % on advice of **WPPMI**
strncon = -0.0066


*#subheader-PF-coils :

*#constraint-60 : 
icc = 60 * Central solenoid temperature margin lower limit
ixc = 106 * ftmargoh

*#constraint-26 :
icc   = 26 * Central solenoid EOF current density upper limit
ixc   = 38 * fjohc
fjohc = 0.25 * F-value for central solenoid current at end-of-flattop
ixc   = 37 * coheof
coheof   = 13540000.0 * Central solenoid overall current density at end of flat-top (a/m2)

*#constraint-27 :
icc     = 27 * Central solenoid BOP current density upper limit
ixc     = 39 * fjohc0
fjohc0  = 0.25 * F-value for central solenoid current at beginning of pulse
ixc     = 41 * fcohbop

*#constraint-72 : 
icc = 72 * OH stress limit
ixc = 123 * foh_stress
alstroh = 6.0D8 * allowable hoop stress in Central Solenoid structural material (Pa)

*#iteration-variable-122 :
ixc = 122 * oh_steel_frac
oh_steel_frac = 0.8

*#in-iohcl :
iohcl    = 1 * Switch for existence of central solenoid

*#in-isumatoh :
isumatoh = 5 * WST Nb3Sn parameterisation

*#in-isumatpf : using NbTi in PF coils after discussion with **WPMAG**
isumatpf = 3 * Switch for superconductor material in pf coils;

*#in-ohhghf :
ohhghf   = 0.9 * Central solenoid height / tf coil internal height

*#in-fcuohsu :
fcuohsu = 0.70 * copper fraction of strand in central solenoid cable 

*#in-ngrp :
ngrp = 4 * Number of groups of pf coils

*#in-cptdin :
cptdin   = 4.22d4, 4.22d4, 4.22d4, 4.22d4, 4.3d4, 4.3d4,  4.3d4, 4.3d4, * Peak current per turn input for pf coil i (a)

*#in-ipfloc :
ipfloc   = 2,2,3,3 * Switch for locating scheme of pf coil group i;

*#in-ncls :
ncls     = 1,1,2,2, * Number of pf coils in group j

*#rjconpf : 
rjconpf  = 1.1d7, 1.1d7, 6.d6, 6.d6, 8.d6, 8.0d6, 8.0d6, 8.0d6, * Average winding pack current density of pf coil i (a/m2)

*#in-rpf2 :
rpf2     = -1.825 * Offset (m) of radial position of ipfloc=2 pf coils

*#in-zref :
zref(1) = 3.6
zref(2) = 1.2
zref(3) = 1.0
zref(4) = 2.8
zref(5) = 1.0
zref(6) = 1.0
zref(7) = 1.0
zref(8) = 1.0


*#header-Breeder-blanket :

*#in-vfshld : 
vfshld   = 0.60 * Coolant void fraction in shield

*#in-iblanket
iblanket = 3